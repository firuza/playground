
<!-- https://stackoverflow.com/questions/23091555/how-do-i-use-javascript-to-clone-an-svg-element -->

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <title>Title</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
</head>

<body style='font-family:arial' onload="loadComponents()">

    <p>Double click on the component in the left pane to place it on the right pane</p>
    <button onclick="printListofComponents()">Display List of Compoents on the grid</button>

    <div id="svgDiv">
        <!-- Components panel STARTS-->
        <svg id="LeftPaneSVG" width="200" height="500" xmlns="http://www.w3.org/2000/svg" style='background-color:lightgray; '>

            <!-- Place components here using javascript function loadComponents() -->

        </svg> 
        <!-- Components panel ENDS-->

        <!-- Grid  STARTS-->
        <!-- Grid code by pigabo (https://codepen.io/pigabo/pen/eAiLF) -->
        <svg id="gridSVG" width="600" height="500" xmlns="http://www.w3.org/2000/svg" style='background-color:white; border:1px solid black;'>

            <g id="gridRightPane">

            <defs>
                <pattern id="smallGrid" width="10" height="10" patternUnits="userSpaceOnUse">
                    <path d="M 10 0 L 0 0 0 10" fill="none" stroke="gray" stroke-width="0.5" />
                </pattern>
                <pattern id="grid" width="100" height="100" patternUnits="userSpaceOnUse">
                    <rect width="100" height="100" fill="url(#smallGrid)" />
                    <path d="M 100 0 L 0 0 0 100" fill="none" stroke="gray" stroke-width="1" />
                </pattern>
            </defs>
            <rect width="100%" height="100%" fill="url(#grid)" id="rectgrid"/>
        </g>
        </svg>
        <!-- Grid  ENDS-->

    </div>

    <p id="listofcomponents">

    </p>

    <script src='https://unpkg.com/panzoom@8.7.3/dist/panzoom.min.js'></script>
    <script src='https://code.jquery.com/jquery-3.4.1.min.js'></script>
    <script>
        var count = 1
        var Root = gridRightPane

        function loadComponents() {
            var loadon = LeftPaneSVG;

            //Component 1
            const comp1 = document.createElementNS("http://www.w3.org/2000/svg", "path");
            comp1.setAttribute("id", "triangle1");
            comp1.setAttribute("ondblclick", "clone_component(triangle1)");
            comp1.setAttribute("d", "M30 60 10 90 50 90 Z");
            comp1.setAttribute("fill", "blue");

            //Component 2
            const comp2triangle = document.createElementNS("http://www.w3.org/2000/svg", "path");
            comp2triangle.setAttribute("d", "M80 60 L60 90 L100 90 Z");
            comp2triangle.setAttribute("fill", "red");

            const comp2circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
            comp2circle.setAttribute("stroke","red");
            comp2circle.setAttribute("stroke-width","4");
            comp2circle.setAttribute("fill","none");
            comp2circle.setAttribute("cx","80");
            comp2circle.setAttribute("cy","80");
            comp2circle.setAttribute("r","30");

            const comp2 = document.createElementNS("http://www.w3.org/2000/svg", "g");
            comp2.setAttribute("id", "comp2");
            comp2.setAttribute("ondblclick", "clone_component(comp2)");
            comp2.appendChild(comp2circle)
            comp2.appendChild(comp2triangle)

            //Place all components on SVG
            loadon.appendChild(comp1);
            loadon.appendChild(comp2);
        }

        function clone_component(component) {
            var newComp = component.cloneNode(true)
            newComp.id = "newComp" + count
            newComp.ondblclick = ""
            var position = "translate(" + 30 + "," + 100 + ")"
            newComp.setAttribute("transform", position)
            Root.appendChild(newComp)
            draggable = new PlainDraggable(document.getElementById('newComp' + count));
            draggable.snap = {x: {step: 10}, y: {step: 10}};
            count = count + 1
        }

        function printListofComponents() {
            var components = document.getElementById("gridRightPane").childNodes;
            var txt = "<h3>List of Components</h3>";
            var i;
            for (i = 0; i < components.length; i++) {
                if (components[i].nodeName.toLowerCase() == "path") {
                    txt = txt + components[i].id  + "<br />";
                }
            }

            document.getElementById("listofcomponents").innerHTML = txt;
        }

        function changeColor() {
            $('#triangle1').css({ fill: "yellow" });
        }

        var element = document.getElementById('gridRightPane')
        panzoom(element)
    </script>
    <script src="plain-draggable.min.js"></script>


</body>

</html>